<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cofre da Sorte</title>
  
 
  <link rel="shortcut icon" type="image/x-icon" href="{{ url_for('static', filename='imagens/favicon.png') }}">
  
  
 <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
  
  
  <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/style.css') }}">
  
  
  <script src="https://www.google.com/recaptcha/api.js?render=6Lc2-q8qAAAAAF8c69VaSI1SRKIenNoCi-GCgTKv"></script>
</head>
<body onload="updateClock('{{ safe.reset_time.isoformat() }}')">

  <div id="preloader">
    <div id="preloaderText"></div>
    <div id="progressBar">
        <div id="progressFill"></div>
    </div>
 </div>
  
    
    <div class="progress-track">
      <div class="progress-fill" id="progressFill"></div>
    </div>
  </div>

  
  <header class="apple-header"></header>

  
  <section class="quick-links-container">
    <h2>Links rápidos</h2>
    <div class="quick-links-buttons">
      
      <a 
        class="link-button" 
        href="https://www.instagram.com/p/DFJb-uFtzLb/?igsh=MXRnZm5pNWlyaW16ZQ==" 
        target="_blank"
      >
        Post da Promoção ↗
      </a>

      
      <a 
        class="link-button" 
        href="https://wa.me/5531996765285"
        target="_blank"
      >
        Seja um patrocinador ↗
      </a>

      <a 
        class="link-button" 
        href="#form-cofre"
      >
        Tentar a Sorte ↗
      </a>

      <a 
        class="link-button"
        href="#premio-cofre"
      >
        Prêmio do Cofre ↗
      </a>

      <a 
        class="link-button"
        href="#premio-cofre"
      >
        Regras Cofre ↗
      </a>
    </div>
  </section>

  <div class="mobile-nav">

    <button class="hamburger-button" onclick="toggleMobileMenu()">
    ☰
  </button>

  <ul class="mobile-menu" id="mobileMenu">
    <li><a href="https://www.instagram.com/p/DFJb-uFtzLb/?igsh=MXRnZm5pNWlyaW16ZQ==" target="_blank">Post da Promoção ↗</a></li>
    <li><a href="https://wa.me/5531996765285" target="_blank">Seja um patrocinador ↗</a></li>
    <li><a href="#form-cofre">Tentar a Sorte ↗</a></li>
    <li><a href="#premio-cofre">Prêmio do Cofre ↗</a></li>
    <li><a href="#premio-cofre">Regras Cofre ↗</a></li>
  </ul>
</div>

  <section class="hero-section">
    <h1 class="hero-title">Hoje é o seu dia de sorte?</h1>
    <p class="hero-subtitle">Descubra agora mesmo ao abrir o Cofre da Sorte.</p>
  </section>

 
<div class="banner-slideshow" id="bannerSlideshow">

  <div class="slide mobile-slide" id="mobileSlide1"></div>
  <div class="slide mobile-slide" id="mobileSlide2"></div>
  <div class="slide mobile-slide" id="mobileSlide3"></div>

  <div class="slide desktop-slide" id="desktopSlide1"></div>
  <div class="slide desktop-slide" id="desktopSlide2"></div>
  <div class="slide desktop-slide" id="desktopSlide3"></div>

  <div class="dots-container mobile-only" id="mobileDots">
    <span class="dot mobile-dot active" data-slide="0"></span>
    <span class="dot mobile-dot" data-slide="1"></span>
    <span class="dot mobile-dot" data-slide="2"></span>
  </div>

  <div class="dots-container desktop-only" id="desktopDots">
    <span class="dot desktop-dot active" data-slide="0"></span>
    <span class="dot desktop-dot" data-slide="1"></span>
    <span class="dot desktop-dot" data-slide="2"></span>
  </div>
</div>

  {% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    <div class="flashes">
      {% for category, message in messages %}
        <div class="message-banner {{ category }}">
          {{ message }}
        </div>
      {% endfor %}
    </div>
  {% endif %}
{% endwith %}
    

  <section class="numbers-instruction">
      <h2>Escolha 6 números de 1 a 60</h2>
    </section>
    

  <section class="form-container-section" id="form-cofre">
      <form method="POST" class="form-container" onsubmit="onSubmit(event)">
        {{ form.hidden_tag() }}

        <div class="form-group">
          <label for="username">Seu @ do Instagram</label>
          <input 
            type="text"
            id="username"
            name="username"
            required
            placeholder="@seuusuario"
            maxlength="100"
          >
        </div>


        <div class="digit-display">
          <span id="digit1"></span>
          <span id="digit2"></span>
          <span id="digit3"></span>
          <span id="digit4"></span>
          <span id="digit5"></span>
          <span id="digit6"></span>
        </div>


        <div class="numbers-grid">
          {% for i in range(1, 61) %}
            <button 
              type="button"
              class="num-btn"
              onclick="toggleNumber(this, '{{ i }}')"
              aria-pressed="false"
            >{{ i }}</button>
          {% endfor %}
        </div>


        <input type="hidden" id="numbers" name="numbers" value="">


        <input type="hidden" id="recaptchaResponse" name="g-recaptcha-response">
      

        <button type="submit" class="submit-btn">Tentar Abrir o Cofre</button>
      </form>


    <div class="clock-container">
        <p>Tempo para o reset: <span id="clock"></span></p>
      </div>


    
      <section class="attempts-list-container">
        <section class="attempts-list">
          <h2>Tentativas Recentes</h2>
          <ul>
            {% for attempt in attempts %}
              {% if safe.winner == attempt.username %}
            
                <li>
                  {{ attempt.timestamp.strftime('%d/%m/%Y %H:%M:%S') }} - 
                  Parabéns, você acertou a senha: {{ attempt.attempt }}
                </li>
              {% else %}
            
                <li>
                  {{ attempt.timestamp.strftime('%d/%m/%Y %H:%M:%S') }} - 
                  {{ attempt.username }} - senha incorreta: {{ attempt.attempt }}
                </li>
              {% endif %}
            {% endfor %}
          </ul>
        </section>
      </section>

    <div class="banner-header">
      <h2 id="unique-title">Últimos Ganhadores e Patrocinadores </h2>
      <p id="unique-subtitulo">Seja você o próximo.</p>
  </div>
  

 <div class="banner-container">
  <div class="banner-item">
      <img src="/static/imagens/avatar1.jpg" alt="avatar1">
      <h2>Ganhador</h2>
      <h2>Carregando...</h2>
      <p>R$500 Reais</p>
      <a href="#">Veja mais</a>
  </div>
  <div class="banner-item">
      <img src="/static/imagens/avatar2.jpeg" alt="avatar2">
      <h2>Patrocinador</h2>
      <h2>@mullerfp </h2>
      <p>R$500 Reais</p>
      <a href="https://www.instagram.com/mullerfp?igsh=MWxqNDFwb2RyOHVsMw%3D%3D&utm_source=qr">Veja mais</a>
  </div>
  <div class="banner-item">
      <img src="/static/imagens/avatar3.jpg" alt="avatar3">
      <h2>Terceiro Ganhador</h2>
      <p>Carregando</p>
      <a href="#">Veja mais</a>
  </div>
</div>
  
  {% if show_video %}
<div class="video-overlay" id="videoModal">
  <div class="video-content">
    <!-- Botão de fechar com contador -->
    <button class="close-btn" id="closeVideoBtn" disabled>
      Fechar em <span id="countdown">5</span>
    </button>

    <!-- Iframe do YouTube, com URL 'embed' e autoplay=1 -->
    <div class="video-wrapper">
<iframe
    id="videoIframe"
    src="https://youtu.be/_-ffknzPOH8?autoplay=1&enablejsapi=1&mute=1"
    frameborder="0"
    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
    allowfullscreen>
</iframe>
    </div>
  </div>
</div>
{% endif %}

<section class="prize-info improved-box" id="premio-cofre">
  
  <header class="prize-header">
    <h2 class="prize-title">Prêmio do Cofre</h2>
    <p class="prize-subtitle">Um prêmio exclusivo esperando por você.</p>
  </header>

  <div class="prize-content">
    <p>Este cofre contém: <strong>{{ safe.prize }}</strong></p>
    <p>Para participar, siga o perfil do patrocinador: <a href="https://www.instagram.com/mullerfp?igsh=MWxqNDFwb2RyOHVsMw%3D%3D&utm_source=qr" target="_blank">@patrocinador_oficial</a>
      e interaja no <a href="https://www.instagram.com/p/DFJb-uFtzLb/?igsh=MXRnZm5pNWlyaW16ZQ==" target="_blank">PostOficial</a>.</p>
  </div>

  <div class="rules-container">
    <h3>Regras para Ganhar</h3>
    <ul>
      <li>↗ Seguir @patrocinador_oficial no Instagram antes de abrir o cofre.</li>
      <li>↗ Curtir, comentar e compartilhar o Post Oficial antes de abrir o cofre.</li>
      <li>↗ O vencedor será validado pela ordem das ações antes de abrir o cofre(seguir, curtir, comentar e compartilhar).</li>
      <li>↗ Para conferência sera verificado a data e hora de abertura do cofre.</li>
      <li>↗ Caso não cumpra todas as regras antes de abrir o cofre, perderá o direito ao prêmio.</li>
    </ul>
  </div>
</section>

<footer class="apple-footer">
  <div class="footer-info">
    <h3>Como Funciona o Cofre da Sorte e Termos de Uso</h3>
    <p>
      O <strong>Cofre da Sorte</strong> é um sistema de premiação online que possibilita a participação de qualquer pessoa utilizando apenas seu @ do Instagram. Para participar, o usuário escolhe 6 números e, a cada reset, uma nova combinação é gerada. Caso a combinação escolhida seja a correta, o prêmio é automaticamente transferido para o vencedor.
    </p>
    <p>
      Ao tentar abrir o cofre, o participante <strong>aceita automaticamente</strong> estes Termos de Uso e Condições de Participação, que incluem, mas não se limitam, às seguintes regras:
    </p>
    <ul style="margin-left: 1rem; line-height: 1.6;">
      <li>
        <strong>Validação das Regras:</strong> Se o participante tentar abrir o cofre sem cumprir todas as regras – como seguir o perfil oficial com um perfil oficial do participante, curtir, comentar e compartilhar no post da promoção – a tentativa será invalidada. Nesse caso, o cofre será automaticamente resetado, gerando uma nova combinação, e o prêmio retornará ao saldo do cofre.
      </li>
      <li>
        <strong>Uso de Bots ou Artifícios Indevidos:</strong> Caso seja identificada a utilização de bots, scripts automatizados ou quaisquer outros artifícios que visem fraudar a participação, a tentativa será desclassificada e o prêmio permanecerá no cofre. Nossa tecnologia de segurança e monitoramento detecta e coibirá essas práticas para garantir a integridade da promoção.
      </li>
      <li>
        <strong>Coleta de Dados:</strong> Não coletamos dados pessoais sensíveis. São registrados apenas os dados mínimos necessários para validar a participação e identificar o(a) vencedor(a).
      </li>
      <li>
        <strong>Responsabilidade:</strong> Em caso de falhas técnicas, erros ou instabilidades momentâneas no site, a equipe do Cofre da Sorte se reserva o direito de tomar as medidas necessárias para manter a integridade da promoção. Quaisquer dúvidas ou inconsistências serão avaliadas e comunicadas aos participantes.
      </li>
    </ul>
    <p>
      É de responsabilidade do participante a leitura atenta destes Termos de Uso antes de tentar abrir o cofre. Ao participar, você concorda integralmente com todas as condições estipuladas, comprometendo-se a agir de acordo com as regras aqui estabelecidas.
    </p>
    <p style="font-size: 0.9rem; color: #666;">
      Em caso de dúvidas ou para mais informações, entre em contato conosco.
    </p>
  </div>
  <p style="font-size: 0.9rem; color: #666; margin-top:1rem;">
    Cofre da Sorte - Direitos Reservados 2024
  </p>
  <p style="margin-top: 1rem; font-size: 0.8rem; color: #666;">
    Este site utiliza SSL/TLS e reCAPTCHA para proteger os dados dos usuários e garantir uma navegação segura.
  </p>
</footer>

<script async src="https://www.googletagmanager.com/gtag/js?id=G-PYMW6C1RB0"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-PYMW6C1RB0');
</script>
<script>
  // Função para carregar a API do YouTube e inicializar o player
function onYouTubeIframeAPIReady() {
  // Inicializa o player do YouTube
  const player = new YT.Player('videoIframe', {
    events: {
      'onReady': onPlayerReady,
      'onStateChange': onPlayerStateChange
    }
  });

  // Inicializa o contador
  let countdownValue = 5;
  const countdownElement = document.getElementById('countdown');
  const closeBtn = document.getElementById('closeVideoBtn');

  // Função para atualizar o contador
  function updateCountdown() {
    if (countdownValue > 0) {
      countdownElement.textContent = countdownValue;  // Atualiza o contador no botão
      countdownValue--;  // Decrementa o contador
    } else {
      countdownElement.textContent = 'X';  // Exibe o "X" para fechar
      closeBtn.disabled = false;  // Habilita o botão de fechar
    }
  }

  // Atualiza o contador a cada 1 segundo
  const countdownInterval = setInterval(updateCountdown, 1000);

  // Fechar o modal ao clicar no botão
  closeBtn.addEventListener('click', function() {
    // Para o vídeo
    player.stopVideo();  // Método que para o vídeo
    document.getElementById('videoModal').style.display = 'none';  // Fecha o modal
    clearInterval(countdownInterval);  // Para o contador
  });
}

// Função chamada quando o player está pronto
function onPlayerReady(event) {
  event.target.playVideo();  // Garante que o vídeo começa automaticamente
}

// Função chamada quando o estado do player muda
function onPlayerStateChange(event) {
  // Verifica quando o vídeo terminar
  if (event.data === YT.PlayerState.ENDED) {
    // Fecha automaticamente o modal quando o vídeo terminar
    document.getElementById('videoModal').style.display = 'none';
  }
}

// Carregar a API do YouTube de forma assíncrona
var tag = document.createElement('script');
tag.src = "https://www.youtube.com/iframe_api";
var firstScriptTag = document.getElementsByTagName('script')[0];
firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
</script>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
        const preloader = document.getElementById('preloader');
        const progressFill = document.getElementById('progressFill');
        const preloaderText = document.getElementById('preloaderText');

        const frases = [
            "Carregando sua sorte...",
            "Abrir o cofre sem regras? Não vale!",
            "Hoje é seu dia de sorte!",
            "Cuidado! Sem regras, sem prêmio!",
            "Prepare-se para ganhar!",
            "Só mais um instante...",
            "Se não seguiu as regras, perdeu!",
            "A sorte está a caminho...",
            "Que a sorte esteja com você!",
            "Verificando suas possibilidades..."
        ];

        function iniciarPreloader() {
          
            const hasVisitedBefore = localStorage.getItem('visitedBefore');
            
            if (!hasVisitedBefore) {
              
                const fraseAleatoria = frases[Math.floor(Math.random() * frases.length)];
                preloaderText.textContent = fraseAleatoria;
                
                preloader.style.display = 'flex';
                
                progressFill.style.width = '0%';

                let progress = 0;
                const progressInterval = setInterval(() => {
                    if (progress < 90) {
                        progress += 1;
                        progressFill.style.width = progress + '%';
                    }
                }, 30);

                window.addEventListener('load', function() {
                    clearInterval(progressInterval);

                                    
                    progressFill.style.width = '100%';
                    
                    setTimeout(() => {
                        preloader.style.display = 'none';
                        localStorage.setItem('visitedBefore', 'true');
                    }, 500);
                });
            } else {
              
                preloader.style.display = 'none';
            }
        }
      
        iniciarPreloader();

    window.scrollTo(0, 0);
    });
    </script>


  <script>
    
    let selectedNumbers = [];
    function toggleNumber(button, number) {
      const num = parseInt(number, 10);
      if (selectedNumbers.includes(num)) {
        selectedNumbers = selectedNumbers.filter(n => n !== num);
        button.classList.remove('selected');
        button.setAttribute('aria-pressed', 'false');
      } else if (selectedNumbers.length < 6) {
        selectedNumbers.push(num);
        button.classList.add('selected');
        button.setAttribute('aria-pressed', 'true');
      }
      updateDisplay();
    }

    function updateDisplay() {
      const display = document.querySelectorAll('.digit-display span');
      display.forEach((span, index) => {
        span.textContent = selectedNumbers[index] || '';
        if (selectedNumbers[index]) {
          span.classList.add('selected');
        } else {
          span.classList.remove('selected');
        }
      });
      const hiddenInput = document.querySelector("input[name='numbers']");
      hiddenInput.value = selectedNumbers.join(',');
    }

    function updateClock(resetTime) {
      const resetDate = new Date(resetTime);
      const now = new Date();
      const diff = resetDate - now;

      if (diff <= 0) {
        document.getElementById("clock").innerText = "Resetando...";
        return;
      }

      const hours = Math.floor(diff / (1000 * 60 * 60));
      const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
      const seconds = Math.floor((diff % (1000 * 60)) / 1000);
      document.getElementById("clock").innerText = `${hours}h ${minutes}m ${seconds}s`;

      if (diff > 0) {
        setTimeout(() => updateClock(resetTime), 1000);
      }
    }
  </script>

<script>
  document.addEventListener('DOMContentLoaded', function() {
  
  
    const isMobile = window.matchMedia("(max-width: 768px)").matches;
  
    let slides = [];
    let dots = [];
  
    if (isMobile) {
      
      const slideM1 = document.getElementById('mobileSlide1');
      const slideM2 = document.getElementById('mobileSlide2');
      const slideM3 = document.getElementById('mobileSlide3');
      
      slideM1.style.backgroundImage = "url('/static/imagens/mobile-banner1.png')";
      slideM2.style.backgroundImage = "url('/static/imagens/mobile-banner2.png')";
      slideM3.style.backgroundImage = "url('/static/imagens/mobile-banner3.png')";
      slides = [slideM1, slideM2,slideM3,];
      dots = document.querySelectorAll('.mobile-dot');
  
    } else {
      
      const slideD1 = document.getElementById('desktopSlide1');
      const slideD2 = document.getElementById('desktopSlide2');
      const slideD3 = document.getElementById('desktopSlide3');
      
      slideD1.style.backgroundImage = "url('/static/imagens/desktop-banner1.png')";
      slideD2.style.backgroundImage = "url('/static/imagens/desktop-banner2.png')";
      slideD3.style.backgroundImage = "url('/static/imagens/desktop-banner3.png')";
      slides = [slideD1, slideD2,slideD3,];
      dots = document.querySelectorAll('.desktop-dot');
    }

    

        let currentSlide = 0;
  
    function showSlide(index) {
      
      slides.forEach(s => s.classList.remove('active'));
      dots.forEach(d => d.classList.remove('active'));

      
      slides[index].classList.add('active');
      dots[index].classList.add('active');
  
      currentSlide = index;
    }
  
    function nextSlide() {
      let newIndex = currentSlide + 1;
      if (newIndex >= slides.length) {
        newIndex = 0;
      }
      showSlide(newIndex);
    }
  
    let slideInterval = setInterval(nextSlide, 5000);

    
    dots.forEach((dot, i) => {
      dot.addEventListener('click', function() {
        showSlide(i);
        clearInterval(slideInterval);
        slideInterval = setInterval(nextSlide, 5000);
      });
    });
  
    if (slides.length > 0) {
      showSlide(0);
    }
  });
  </script>

<script>
  function toggleMobileMenu() {
    const menu = document.getElementById('mobileMenu');
    menu.classList.toggle('open');
  }
</script>

 <script>
  function onSubmit(event) {
    event.preventDefault();
    grecaptcha.ready(function() {
      grecaptcha.execute('6Lc2-q8qAAAAAF8c69VaSI1SRKIenNoCi-GCgTKv', {action: 'login'}).then(function(token) {
        document.getElementById('recaptchaResponse').value = token;
        document.forms[0].submit(); 
      });
    });
  }
</script>
  
</body>
</html>
